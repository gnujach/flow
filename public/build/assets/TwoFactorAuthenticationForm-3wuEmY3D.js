import{J}from"./Modal-DqQiNYOK.js";import{J as C}from"./Button-DYi5d6FP.js";import{d as y,r as d,e as a,o as s,a as n,b as r,M as F,w as t,g as i,n as b,t as f,a1 as T,c as h,f as u,F as A,h as M}from"./app-CArJwsA3.js";import{J as S}from"./DialogModal-DK6pd8Sm.js";import{J as R}from"./Input-BI_iGO1Y.js";import{J as B}from"./InputError-U-lskrRX.js";import{J as v}from"./SecondaryButton-DDAPIt3K.js";import{_}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{J as E}from"./DangerButton-CXGNpOgL.js";import"./SectionTitle-DbZK12cy.js";const V=y({emits:["confirmed"],props:{title:{default:"Confirmar Password"},content:{default:"Por su seguridad, confirme su contraseña para continuar."},button:{default:"Confirmar"}},components:{JetButton:C,JetDialogModal:S,JetInput:R,JetInputError:B,JetSecondaryButton:v},data(){return{confirmingPassword:!1,form:{password:"",error:""}}},methods:{startConfirmingPassword(){axios.get(route("password.confirmation")).then(e=>{e.data.confirmed?this.$emit("confirmed"):(this.confirmingPassword=!0,setTimeout(()=>this.$refs.password.focus(),250))})},confirmPassword(){this.form.processing=!0,axios.post(route("password.confirm"),{password:this.form.password}).then(()=>{this.form.processing=!1,this.closeModal(),this.$nextTick(()=>this.$emit("confirmed"))}).catch(e=>{this.form.processing=!1,this.form.error=e.response.data.errors.password[0],this.$refs.password.focus()})},closeModal(){this.confirmingPassword=!1,this.form.password="",this.form.error=""}}}),q={class:"mt-4"};function D(e,o,k,j,$,P){const p=d("jet-input"),l=d("jet-input-error"),m=d("jet-secondary-button"),g=d("jet-button"),w=d("jet-dialog-modal");return s(),a("span",null,[n("span",{onClick:o[0]||(o[0]=(...c)=>e.startConfirmingPassword&&e.startConfirmingPassword(...c))},[F(e.$slots,"default")]),r(w,{show:e.confirmingPassword,onClose:e.closeModal},{title:t(()=>[i(f(e.title),1)]),content:t(()=>[i(f(e.content)+" ",1),n("div",q,[r(p,{type:"password",class:"mt-1 block w-3/4",placeholder:"Password",ref:"password",modelValue:e.form.password,"onUpdate:modelValue":o[1]||(o[1]=c=>e.form.password=c),onKeyup:T(e.confirmPassword,["enter"])},null,8,["modelValue","onKeyup"]),r(l,{message:e.form.error,class:"mt-2"},null,8,["message"])])]),footer:t(()=>[r(m,{onClick:e.closeModal},{default:t(()=>[...o[2]||(o[2]=[i(" Cancel ",-1)])]),_:1},8,["onClick"]),r(g,{class:b(["ml-3",{"opacity-25":e.form.processing}]),onClick:e.confirmPassword,disabled:e.form.processing},{default:t(()=>[i(f(e.button),1)]),_:1},8,["onClick","class","disabled"])]),_:1},8,["show","onClose"])])}const L=_(V,[["render",D]]),N=y({components:{JetActionSection:J,JetButton:C,JetConfirmsPassword:L,JetDangerButton:E,JetSecondaryButton:v},data(){return{enabling:!1,disabling:!1,qrCode:null,recoveryCodes:[]}},methods:{enableTwoFactorAuthentication(){this.enabling=!0,this.$inertia.post("/user/two-factor-authentication",{},{preserveScroll:!0,onSuccess:()=>Promise.all([this.showQrCode(),this.showRecoveryCodes()]),onFinish:()=>this.enabling=!1})},showQrCode(){return axios.get("/user/two-factor-qr-code").then(e=>{this.qrCode=e.data.svg})},showRecoveryCodes(){return axios.get("/user/two-factor-recovery-codes").then(e=>{this.recoveryCodes=e.data})},regenerateRecoveryCodes(){axios.post("/user/two-factor-recovery-codes").then(e=>{this.showRecoveryCodes()})},disableTwoFactorAuthentication(){this.disabling=!0,this.$inertia.delete("/user/two-factor-authentication",{preserveScroll:!0,onSuccess:()=>this.disabling=!1})}},computed:{twoFactorEnabled(){return!this.enabling&&this.$page.props.user.two_factor_enabled}}}),K={key:0,class:"text-lg font-medium text-gray-900"},Q={key:1,class:"text-lg font-medium text-gray-900"},z={key:2},G={key:0},H=["innerHTML"],I={key:1},U={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 rounded-lg"},O={class:"mt-5"},W={key:0},X={key:1};function Y(e,o,k,j,$,P){const p=d("jet-button"),l=d("jet-confirms-password"),m=d("jet-secondary-button"),g=d("jet-danger-button"),w=d("jet-action-section");return s(),h(w,null,{title:t(()=>[...o[0]||(o[0]=[i(" Autentificación de doble paso ",-1)])]),description:t(()=>[...o[1]||(o[1]=[i(" Protege tu cuenta agregando doble paso de autentificación ",-1)])]),content:t(()=>[e.twoFactorEnabled?(s(),a("h3",K," Tienes habilitado el doble paso en tu cuenta ")):(s(),a("h3",Q," Aún no tienes habilitado el doble paso en la autentificación ")),o[8]||(o[8]=n("div",{class:"mt-3 max-w-xl text-sm text-gray-600"},[n("p",null," Cuando la autenticación de dos factores está habilitada, se le solicitará un token aleatorio seguro durante la autenticación. Puede recuperar este token desde la aplicación Google Authenticator de su teléfono. ")],-1)),e.twoFactorEnabled?(s(),a("div",z,[e.qrCode?(s(),a("div",G,[o[2]||(o[2]=n("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[n("p",{class:"font-semibold"}," La autenticación de dos factores ahora está habilitada. Escanee el siguiente código QR usando la aplicación de autenticación de su teléfono. ")],-1)),n("div",{class:"mt-4",innerHTML:e.qrCode},null,8,H)])):u("",!0),e.recoveryCodes.length>0?(s(),a("div",I,[o[3]||(o[3]=n("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[n("p",{class:"font-semibold"}," Guarde estos códigos de recuperación en un administrador de contraseñas seguro. Se pueden utilizar para recuperar el acceso a su cuenta si pierde su dispositivo de autenticación de dos factores. ")],-1)),n("div",U,[(s(!0),a(A,null,M(e.recoveryCodes,c=>(s(),a("div",{key:c},f(c),1))),128))])])):u("",!0)])):u("",!0),n("div",O,[e.twoFactorEnabled?(s(),a("div",X,[r(l,{onConfirmed:e.regenerateRecoveryCodes},{default:t(()=>[e.recoveryCodes.length>0?(s(),h(m,{key:0,class:"mr-3"},{default:t(()=>[...o[5]||(o[5]=[i(" Regenerar códigos de recuperación ",-1)])]),_:1})):u("",!0)]),_:1},8,["onConfirmed"]),r(l,{onConfirmed:e.showRecoveryCodes},{default:t(()=>[e.recoveryCodes.length===0?(s(),h(m,{key:0,class:"mr-3"},{default:t(()=>[...o[6]||(o[6]=[i(" Mostrar códigos de recuperación ",-1)])]),_:1})):u("",!0)]),_:1},8,["onConfirmed"]),r(l,{onConfirmed:e.disableTwoFactorAuthentication},{default:t(()=>[r(g,{class:b({"opacity-25":e.disabling}),disabled:e.disabling},{default:t(()=>[...o[7]||(o[7]=[i(" Desactivar ",-1)])]),_:1},8,["class","disabled"])]),_:1},8,["onConfirmed"])])):(s(),a("div",W,[r(l,{onConfirmed:e.enableTwoFactorAuthentication},{default:t(()=>[r(p,{type:"button",class:b({"opacity-25":e.enabling}),disabled:e.enabling},{default:t(()=>[...o[4]||(o[4]=[i(" Permitir ",-1)])]),_:1},8,["class","disabled"])]),_:1},8,["onConfirmed"])]))])]),_:1})}const de=_(N,[["render",Y]]);export{de as default};
