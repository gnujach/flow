import{d as J,e as W}from"./form-CO_oVJRj.js";import{o as h,i as j,A as C,N,u as P,f as X,E as Y,b as Z,T as _,a as g}from"./keyboard-DJJQ75-z.js";import{l as ee,i as A,d as te,e as le,h as ae,t as oe,O as ue}from"./open-closed-B45GE6EM.js";import{s as ne}from"./use-resolve-button-type-ty-xYOe2.js";import{v as S,d as E,k as x,s as V,z as re,G as K,R as ie,y as $,S as se,J as z,F as ve,U as de,I as D}from"./app-CArJwsA3.js";function U(e){return[e.screenX,e.screenY]}function pe(){let e=S([-1,-1]);return{wasMoved(r){let u=U(r);return e.value[0]===u[0]&&e.value[1]===u[1]?!1:(e.value=u,!0)},update(r){e.value=U(r)}}}function fe(e){throw new Error("Unexpected object: "+e)}var O=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(O||{});function ce(e,r){let u=r.resolveItems();if(u.length<=0)return null;let d=r.resolveActiveIndex(),i=d??-1;switch(e.focus){case 0:{for(let l=0;l<u.length;++l)if(!r.resolveDisabled(u[l],l,u))return l;return d}case 1:{i===-1&&(i=u.length);for(let l=i-1;l>=0;--l)if(!r.resolveDisabled(u[l],l,u))return l;return d}case 2:{for(let l=i+1;l<u.length;++l)if(!r.resolveDisabled(u[l],l,u))return l;return d}case 3:{for(let l=u.length-1;l>=0;--l)if(!r.resolveDisabled(u[l],l,u))return l;return d}case 4:{for(let l=0;l<u.length;++l)if(r.resolveId(u[l],l,u)===e.id)return l;return d}case 5:return null;default:fe(e)}}let q=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function H(e){var r,u;let d=(r=e.innerText)!=null?r:"",i=e.cloneNode(!0);if(!(i instanceof HTMLElement))return d;let l=!1;for(let m of i.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))m.remove(),l=!0;let t=l?(u=i.innerText)!=null?u:"":d;return q.test(t)&&(t=t.replace(q,"")),t}function be(e){let r=e.getAttribute("aria-label");if(typeof r=="string")return r.trim();let u=e.getAttribute("aria-labelledby");if(u){let d=u.split(" ").map(i=>{let l=document.getElementById(i);if(l){let t=l.getAttribute("aria-label");return typeof t=="string"?t.trim():H(l).trim()}return null}).filter(Boolean);if(d.length>0)return d.join(", ")}return H(e).trim()}function me(e){let r=S(""),u=S("");return()=>{let d=h(e);if(!d)return"";let i=d.innerText;if(r.value===i)return u.value;let l=be(d).trim().toLowerCase();return r.value=i,u.value=l,l}}function ge(e,r){return e===r}var xe=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(xe||{}),he=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(he||{}),Oe=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Oe||{});function ye(e){requestAnimationFrame(()=>requestAnimationFrame(e))}let Q=Symbol("ListboxContext");function B(e){let r=de(Q,null);if(r===null){let u=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(u,B),u}return r}let Fe=E({name:"Listbox",emits:{"update:modelValue":e=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>ge},horizontal:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(e,{slots:r,attrs:u,emit:d}){let i=S(1),l=S(null),t=S(null),m=S(null),f=S([]),c=S(""),b=S(null),o=S(1);function s(a=n=>n){let n=b.value!==null?f.value[b.value]:null,v=ue(a(f.value.slice()),y=>h(y.dataRef.domRef)),p=n?v.indexOf(n):null;return p===-1&&(p=null),{options:v,activeOptionIndex:p}}let R=x(()=>e.multiple?1:0),[w,L]=J(x(()=>e.modelValue),a=>d("update:modelValue",a),x(()=>e.defaultValue)),T=x(()=>w.value===void 0?P(R.value,{1:[],0:void 0}):w.value),F={listboxState:i,value:T,mode:R,compare(a,n){if(typeof e.by=="string"){let v=e.by;return(a==null?void 0:a[v])===(n==null?void 0:n[v])}return e.by(a,n)},orientation:x(()=>e.horizontal?"horizontal":"vertical"),labelRef:l,buttonRef:t,optionsRef:m,disabled:x(()=>e.disabled),options:f,searchQuery:c,activeOptionIndex:b,activationTrigger:o,closeListbox(){e.disabled||i.value!==1&&(i.value=1,b.value=null)},openListbox(){e.disabled||i.value!==0&&(i.value=0)},goToOption(a,n,v){if(e.disabled||i.value===1)return;let p=s(),y=ce(a===O.Specific?{focus:O.Specific,id:n}:{focus:a},{resolveItems:()=>p.options,resolveActiveIndex:()=>p.activeOptionIndex,resolveId:k=>k.id,resolveDisabled:k=>k.dataRef.disabled});c.value="",b.value=y,o.value=v??1,f.value=p.options},search(a){if(e.disabled||i.value===1)return;let n=c.value!==""?0:1;c.value+=a.toLowerCase();let v=(b.value!==null?f.value.slice(b.value+n).concat(f.value.slice(0,b.value+n)):f.value).find(y=>y.dataRef.textValue.startsWith(c.value)&&!y.dataRef.disabled),p=v?f.value.indexOf(v):-1;p===-1||p===b.value||(b.value=p,o.value=1)},clearSearch(){e.disabled||i.value!==1&&c.value!==""&&(c.value="")},registerOption(a,n){let v=s(p=>[...p,{id:a,dataRef:n}]);f.value=v.options,b.value=v.activeOptionIndex},unregisterOption(a){let n=s(v=>{let p=v.findIndex(y=>y.id===a);return p!==-1&&v.splice(p,1),v});f.value=n.options,b.value=n.activeOptionIndex,o.value=1},theirOnChange(a){e.disabled||L(a)},select(a){e.disabled||L(P(R.value,{0:()=>a,1:()=>{let n=D(F.value.value).slice(),v=D(a),p=n.findIndex(y=>F.compare(v,D(y)));return p===-1?n.push(v):n.splice(p,1),n}}))}};te([t,m],(a,n)=>{var v;F.closeListbox(),le(n,ae.Loose)||(a.preventDefault(),(v=h(t))==null||v.focus())},x(()=>i.value===0)),se(Q,F),oe(x(()=>P(i.value,{0:A.Open,1:A.Closed})));let I=x(()=>{var a;return(a=h(t))==null?void 0:a.closest("form")});return V(()=>{K([I],()=>{if(!I.value||e.defaultValue===void 0)return;function a(){F.theirOnChange(e.defaultValue)}return I.value.addEventListener("reset",a),()=>{var n;(n=I.value)==null||n.removeEventListener("reset",a)}},{immediate:!0})}),()=>{let{name:a,modelValue:n,disabled:v,form:p,...y}=e,k={open:i.value===0,disabled:v,value:T.value};return z(ve,[...a!=null&&T.value!=null?W({[a]:T.value}).map(([M,G])=>z(X,Y({features:Z.Hidden,key:M,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:p,disabled:v,name:M,value:G}))):[],C({ourProps:{},theirProps:{...u,..._(y,["defaultValue","onUpdate:modelValue","horizontal","multiple","by"])},slot:k,slots:r,attrs:u,name:"Listbox"})])}}}),Pe=E({name:"ListboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(e,{attrs:r,slots:u,expose:d}){var i;let l=(i=e.id)!=null?i:`headlessui-listbox-button-${j()}`,t=B("ListboxButton");d({el:t.buttonRef,$el:t.buttonRef});function m(o){switch(o.key){case g.Space:case g.Enter:case g.ArrowDown:o.preventDefault(),t.openListbox(),$(()=>{var s;(s=h(t.optionsRef))==null||s.focus({preventScroll:!0}),t.value.value||t.goToOption(O.First)});break;case g.ArrowUp:o.preventDefault(),t.openListbox(),$(()=>{var s;(s=h(t.optionsRef))==null||s.focus({preventScroll:!0}),t.value.value||t.goToOption(O.Last)});break}}function f(o){switch(o.key){case g.Space:o.preventDefault();break}}function c(o){t.disabled.value||(t.listboxState.value===0?(t.closeListbox(),$(()=>{var s;return(s=h(t.buttonRef))==null?void 0:s.focus({preventScroll:!0})})):(o.preventDefault(),t.openListbox(),ye(()=>{var s;return(s=h(t.optionsRef))==null?void 0:s.focus({preventScroll:!0})})))}let b=ne(x(()=>({as:e.as,type:r.type})),t.buttonRef);return()=>{var o,s;let R={open:t.listboxState.value===0,disabled:t.disabled.value,value:t.value.value},{...w}=e,L={ref:t.buttonRef,id:l,type:b.value,"aria-haspopup":"listbox","aria-controls":(o=h(t.optionsRef))==null?void 0:o.id,"aria-expanded":t.listboxState.value===0,"aria-labelledby":t.labelRef.value?[(s=h(t.labelRef))==null?void 0:s.id,l].join(" "):void 0,disabled:t.disabled.value===!0?!0:void 0,onKeydown:m,onKeyup:f,onClick:c};return C({ourProps:L,theirProps:w,slot:R,attrs:r,slots:u,name:"ListboxButton"})}}}),Te=E({name:"ListboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(e,{attrs:r,slots:u,expose:d}){var i;let l=(i=e.id)!=null?i:`headlessui-listbox-options-${j()}`,t=B("ListboxOptions"),m=S(null);d({el:t.optionsRef,$el:t.optionsRef});function f(o){switch(m.value&&clearTimeout(m.value),o.key){case g.Space:if(t.searchQuery.value!=="")return o.preventDefault(),o.stopPropagation(),t.search(o.key);case g.Enter:if(o.preventDefault(),o.stopPropagation(),t.activeOptionIndex.value!==null){let s=t.options.value[t.activeOptionIndex.value];t.select(s.dataRef.value)}t.mode.value===0&&(t.closeListbox(),$(()=>{var s;return(s=h(t.buttonRef))==null?void 0:s.focus({preventScroll:!0})}));break;case P(t.orientation.value,{vertical:g.ArrowDown,horizontal:g.ArrowRight}):return o.preventDefault(),o.stopPropagation(),t.goToOption(O.Next);case P(t.orientation.value,{vertical:g.ArrowUp,horizontal:g.ArrowLeft}):return o.preventDefault(),o.stopPropagation(),t.goToOption(O.Previous);case g.Home:case g.PageUp:return o.preventDefault(),o.stopPropagation(),t.goToOption(O.First);case g.End:case g.PageDown:return o.preventDefault(),o.stopPropagation(),t.goToOption(O.Last);case g.Escape:o.preventDefault(),o.stopPropagation(),t.closeListbox(),$(()=>{var s;return(s=h(t.buttonRef))==null?void 0:s.focus({preventScroll:!0})});break;case g.Tab:o.preventDefault(),o.stopPropagation();break;default:o.key.length===1&&(t.search(o.key),m.value=setTimeout(()=>t.clearSearch(),350));break}}let c=ee(),b=x(()=>c!==null?(c.value&A.Open)===A.Open:t.listboxState.value===0);return()=>{var o,s;let R={open:t.listboxState.value===0},{...w}=e,L={"aria-activedescendant":t.activeOptionIndex.value===null||(o=t.options.value[t.activeOptionIndex.value])==null?void 0:o.id,"aria-multiselectable":t.mode.value===1?!0:void 0,"aria-labelledby":(s=h(t.buttonRef))==null?void 0:s.id,"aria-orientation":t.orientation.value,id:l,onKeydown:f,role:"listbox",tabIndex:0,ref:t.optionsRef};return C({ourProps:L,theirProps:w,slot:R,attrs:r,slots:u,features:N.RenderStrategy|N.Static,visible:b.value,name:"ListboxOptions"})}}}),Ie=E({name:"ListboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(e,{slots:r,attrs:u,expose:d}){var i;let l=(i=e.id)!=null?i:`headlessui-listbox-option-${j()}`,t=B("ListboxOption"),m=S(null);d({el:m,$el:m});let f=x(()=>t.activeOptionIndex.value!==null?t.options.value[t.activeOptionIndex.value].id===l:!1),c=x(()=>P(t.mode.value,{0:()=>t.compare(D(t.value.value),D(e.value)),1:()=>D(t.value.value).some(a=>t.compare(D(a),D(e.value)))})),b=x(()=>P(t.mode.value,{1:()=>{var a;let n=D(t.value.value);return((a=t.options.value.find(v=>n.some(p=>t.compare(D(p),D(v.dataRef.value)))))==null?void 0:a.id)===l},0:()=>c.value})),o=me(m),s=x(()=>({disabled:e.disabled,value:e.value,get textValue(){return o()},domRef:m}));V(()=>t.registerOption(l,s)),re(()=>t.unregisterOption(l)),V(()=>{K([t.listboxState,c],()=>{t.listboxState.value===0&&c.value&&P(t.mode.value,{1:()=>{b.value&&t.goToOption(O.Specific,l)},0:()=>{t.goToOption(O.Specific,l)}})},{immediate:!0})}),ie(()=>{t.listboxState.value===0&&f.value&&t.activationTrigger.value!==0&&$(()=>{var a,n;return(n=(a=h(m))==null?void 0:a.scrollIntoView)==null?void 0:n.call(a,{block:"nearest"})})});function R(a){if(e.disabled)return a.preventDefault();t.select(e.value),t.mode.value===0&&(t.closeListbox(),$(()=>{var n;return(n=h(t.buttonRef))==null?void 0:n.focus({preventScroll:!0})}))}function w(){if(e.disabled)return t.goToOption(O.Nothing);t.goToOption(O.Specific,l)}let L=pe();function T(a){L.update(a)}function F(a){L.wasMoved(a)&&(e.disabled||f.value||t.goToOption(O.Specific,l,0))}function I(a){L.wasMoved(a)&&(e.disabled||f.value&&t.goToOption(O.Nothing))}return()=>{let{disabled:a}=e,n={active:f.value,selected:c.value,disabled:a},{value:v,disabled:p,...y}=e,k={id:l,ref:m,role:"option",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,"aria-selected":c.value,disabled:void 0,onClick:R,onFocus:w,onPointerenter:T,onMouseenter:T,onPointermove:F,onMousemove:F,onPointerleave:I,onMouseleave:I};return C({ourProps:k,theirProps:y,slot:n,attrs:u,slots:r,name:"ListboxOption"})}}});export{Te as A,Ie as F,Fe as I,Pe as j};
